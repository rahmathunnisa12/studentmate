<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Flashcards</title>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #f8f2ff;
    --card-bg: #fff;
    --primary: #7c5ef7;
    --text: #333;
    --border-radius: 10px;
    --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    --flip-front-bg: #e9f0ff;   /* Light blue for front */
    --flip-back-bg: #f8ffe9;    /* Light green for back */
  }

  body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg);
    padding: 20px;
    margin: 0;
  }

  .container {
    max-width: 500px;
    margin: auto;
    text-align: center;
  }

  h1 {
    color: var(--primary);
    margin-bottom: 20px;
  }

  .flashcard {
    perspective: 1000px;
    width: 100%;
    min-height: 250px;
    margin: auto;
    position: relative;
  }

  .flashcard-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transition: transform 0.6s;
    transform-style: preserve-3d;
  }

  .flashcard-front,
  .flashcard-back {
    position: absolute;
    width: 100%;
    height: 100%;
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    font-size: 16px;
    color: var(--text);
    border-radius: var(--border-radius);
    box-shadow: var(--shadow);
    padding: 20px;
    cursor: pointer;
  }

  .flashcard-front {
    background: var(--flip-front-bg);
  }

  .flashcard-back {
    background: var(--flip-back-bg);
    transform: rotateY(180deg);
  }

  .flashcard.flipped .flashcard-inner {
    transform: rotateY(180deg);
  }

  .nav-buttons {
    margin-top: 20px;
  }

  button {
    background-color: var(--primary);
    color: white;
    border: none;
    padding: 10px 15px;
    margin: 0 10px;
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 14px;
  }

  a.logout-btn {
    display: block;
    margin-top: 30px;
    color: var(--primary);
    text-decoration: none;
    font-weight: bold;
  }

  a.logout-btn:hover {
    text-decoration: underline;
  }
</style>
</head>
<body>
  <div class="container">
    <h1>üîÅ Flashcard Study Mode</h1>

    <% if (flashcards && flashcards.length > 0) { %>
      <div id="flashcard" class="flashcard" onclick="flipCard()">
  <div class="flashcard-inner">
    <div class="flashcard-front" id="flashcard-front">
      Click to flip
    </div>
    <div class="flashcard-back" id="flashcard-back">
      No content found
    </div>
  </div>
</div>
      </div>

      <div class="nav-buttons">
        <button onclick="prevCard()">‚¨ÖÔ∏è Previous</button>
        <button onclick="nextCard()">Next ‚û°Ô∏è</button>
      </div>
    <% } else { %>
      <p style="margin-top: 40px;">No notes found. Please add some study notes first.</p>
    <% } %>

    <a class="logout-btn" href="/notes">‚Üê Back to Notes</a>
  </div>

  <script>
    // Safely inject flashcards into JS
    const flashcards = [
      <% if (flashcards && flashcards.length > 0) { %>
        <% flashcards.forEach(card => { %>
          {
            front: "<%= card.title.replace(/"/g, '&quot;') %>",
            back: `<%= card.content.replace(/"/g, '&quot;').replace(/\n/g, '\\n').replace(/</g, '<').replace(/>/g, '>') %>`
          },
        <% }) %>
      <% } %>
    ];

    let currentIndex = 0;

    const flashcard = document.getElementById("flashcard");
    const front = document.getElementById("flashcard-front");
    const back = document.getElementById("flashcard-back");

    function showCard(index) {
      if (flashcards.length === 0) return;

      flashcard.classList.remove("flipped");
      front.textContent = flashcards[index].front;
      back.textContent = flashcards[index].back;
    }

    function flipCard() {
      flashcard.classList.toggle("flipped");
    }

    function nextCard() {
      if (flashcards.length === 0) return;
      currentIndex = (currentIndex + 1) % flashcards.length;
      showCard(currentIndex);
    }

    function prevCard() {
      if (flashcards.length === 0) return;
      currentIndex = (currentIndex - 1 + flashcards.length) % flashcards.length;
      showCard(currentIndex);
    }

    window.onload = () => {
      if (flashcards.length > 0) {
        showCard(currentIndex);
      }
    };
  </script>
</body>
</html>